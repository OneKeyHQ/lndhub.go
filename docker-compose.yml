services:
  lndhub:
    image: lndhub:latest
    environment:
      DATABASE_URI: postgresql://user:password@db:5432/lndhub?sslmode=disable
      RABBITMQ_URI: amqp://root:password@rabbitmq:5672
      SUBSCRIPTION_CONSUMER_TYPE: rabbitmq
      JWT_SECRET: superSecret
      LND_ADDRESS: rpc.lnd3.regtest.getalby.com:443
      LND_MACAROON_HEX: 0201036c6e6402f801030a10dd10fe7764ab4115317571e4ccf747d21201301a160a0761646472657373120472656164120577726974651a130a04696e666f120472656164120577726974651a170a08696e766f69636573120472656164120577726974651a210a086d616361726f6f6e120867656e6572617465120472656164120577726974651a160a076d657373616765120472656164120577726974651a170a086f6666636861696e120472656164120577726974651a160a076f6e636861696e120472656164120577726974651a140a057065657273120472656164120577726974651a180a067369676e6572120867656e6572617465120472656164000006208cfab2edeaa289f5dfed9a5edc6388e824227ed5109fa85c67cf66bf7f134f13
    ports:
      - 3000:3000

  db:
    image: postgres:14.2
    environment:
      POSTGRES_DB: lndhub
      POSTGRES_USER: user
      POSTGRES_PASSWORD: password
    ports:
      - 5432:5432

  rabbitmq:
    image: rabbitmq:3.11.8-management
    ports:
      - 5672:5672
      - 15672:15672
    environment:
      RABBITMQ_DEFAULT_USER: root
      RABBITMQ_DEFAULT_PASS: password

  ln-invoice-proxy:
    image: ghcr.io/getalby/ln-event-publisher:main-ed993c4
    volumes:
      - /Users/lucas.rouckhout/Documents/code/scripts/albykube/admin.macaroon:/admin.macaroon
    environment:
      RABBITMQ_URI: amqp://root:password@rabbitmq:5672
      LND_ADDRESS: rpc.lnd3.regtest.getalby.com:443
      LND_MACAROON_FILE: /admin.macaroon
      LND_MACAROON_HEX: 0201036c6e6402f801030a10dd10fe7764ab4115317571e4ccf747d21201301a160a0761646472657373120472656164120577726974651a130a04696e666f120472656164120577726974651a170a08696e766f69636573120472656164120577726974651a210a086d616361726f6f6e120867656e6572617465120472656164120577726974651a160a076d657373616765120472656164120577726974651a170a086f6666636861696e120472656164120577726974651a160a076f6e636861696e120472656164120577726974651a140a057065657273120472656164120577726974651a180a067369676e6572120867656e6572617465120472656164000006208cfab2edeaa289f5dfed9a5edc6388e824227ed5109fa85c67cf66bf7f134f13
      DATABASE_URI: postgresql://user:password@db:5432/lnproxy?sslmode=disable

